apiVersion: v1
kind: Pod
metadata:
  name: kafka-test-consumer
  namespace: kafka
  labels:
    app: kafka-test-consumer
spec:
  containers:
  - name: consumer
    image: quay.io/strimzi/kafka:latest-kafka-4.1.1
    command:
    - /bin/bash
    - -c
    - |
      echo "Starting consumer..."
      # Consume messages slowly to create lag
      /opt/kafka/bin/kafka-console-consumer.sh \
        --bootstrap-server my-cluster-kafka-bootstrap.kafka:9092 \
        --topic test-topic \
        --group test-consumer-group \
        --from-beginning | while read line; do
          echo "$line"
          # Simulate slow processing (10 seconds per message)
          sleep 10
        done
    resources:
      requests:
        memory: "128Mi"
        cpu: "100m"
      limits:
        memory: "256Mi"
        cpu: "200m"
  restartPolicy: Always
